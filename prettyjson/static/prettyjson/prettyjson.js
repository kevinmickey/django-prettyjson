if("undefined"==typeof jQuery&&void 0===django.jQuery)throw new Error("django-prettyjson requires jQuery");(function(e){var t,n,r,o,l;void 0===e.fn.JSONView&&(t=e,o=function(){function e(e){null==e&&(e={}),this.options=e}return e.prototype.htmlEncode=function(e){return null!==e?e.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},e.prototype.jsString=function(e){return e=JSON.stringify(e).slice(1,-1),this.htmlEncode(e)},e.prototype.decorateWithSpan=function(e,t){return'<span class="'+t+'">'+this.htmlEncode(e)+"</span>"},e.prototype.valueToHTML=function(e,t){var n;return null==t&&(t=0),n=Object.prototype.toString.call(e).match(/\s(.+)]/)[1].toLowerCase(),this[n+"ToHTML"].call(this,e,t)},e.prototype.nullToHTML=function(e){return this.decorateWithSpan("null","null")},e.prototype.numberToHTML=function(e){return this.decorateWithSpan(e,"num")},e.prototype.stringToHTML=function(e){var t,n;return/^(http|https|file):\/\/[^\s]+$/i.test(e)?'<a href="'+this.htmlEncode(e)+'"><span class="q">"</span>'+this.jsString(e)+'<span class="q">"</span></a>':(t="",e=this.jsString(e),this.options.nl2br&&(n=/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g,n.test(e)&&(t=" multiline",e=(e+"").replace(n,"$1<br />"))),'<span class="string'+t+'">"'+e+'"</span>')},e.prototype.booleanToHTML=function(e){return this.decorateWithSpan(e,"bool")},e.prototype.arrayToHTML=function(e,t){var n,r,o,l,i,s,a,c;for(null==t&&(t=0),r=!1,i="",l=e.length,o=a=0,c=e.length;c>a;o=++a)s=e[o],r=!0,i+="<li>"+this.valueToHTML(s,t+1),l>1&&(i+=","),i+="</li>",l--;return r?(n=0===t?"":" collapsible",'[<ul class="array level'+t+n+'">'+i+"</ul>]"):"[ ]"},e.prototype.objectToHTML=function(e,t){var n,r,o,l,i,s,a;for(s in null==t&&(t=0),r=!1,i="",l=0,e)l++;for(s in e)a=e[s],r=!0,o=this.options.escape?this.jsString(s):s,i+='<li><span class="prop"><span class="q">"</span>'+o+'<span class="q">"</span></span>: '+this.valueToHTML(a,t+1),l>1&&(i+=","),i+="</li>",l--;return r?(n=0===t?"":" collapsible",'{<ul class="obj level'+t+n+'">'+i+"</ul>}"):"{ }"},e.prototype.jsonToHTML=function(e){return'<div class="jsonview">'+this.valueToHTML(e)+"</div>"},e}(),"undefined"!=typeof module&&null!==module&&(module.exports=o),r=function(){function e(){}return e.bindEvent=function(e,t){var n;return n=document.createElement("div"),n.className="collapser",n.innerHTML=t.collapsed?"+":"-",n.addEventListener("click",function(e){return function(n){return e.toggle(n.target,t)}}(this)),e.insertBefore(n,e.firstChild),t.collapsed?this.collapse(n):void 0},e.expand=function(e){var t,n;return n=this.collapseTarget(e),""!==n.style.display?(t=n.parentNode.getElementsByClassName("ellipsis")[0],n.parentNode.removeChild(t),n.style.display="",e.innerHTML="-"):void 0},e.collapse=function(e){var t,n;return n=this.collapseTarget(e),"none"!==n.style.display?(n.style.display="none",t=document.createElement("span"),t.className="ellipsis",t.innerHTML=" &hellip; ",n.parentNode.insertBefore(t,n),e.innerHTML="+"):void 0},e.toggle=function(e,t){var n,r,o,l,i,s;if(null==t&&(t={}),o=this.collapseTarget(e),n="none"===o.style.display?"expand":"collapse",t.recursive_collapser){for(r=e.parentNode.getElementsByClassName("collapser"),s=[],l=0,i=r.length;i>l;l++)e=r[l],s.push(this[n](e));return s}return this[n](e)},e.collapseTarget=function(e){var t;return t=e.parentNode.getElementsByClassName("collapsible"),t.length?t[0]:void 0},e}(),n=t,l={collapse:function(e){return"-"===e.innerHTML?r.collapse(e):void 0},expand:function(e){return"+"===e.innerHTML?r.expand(e):void 0},toggle:function(e){return r.toggle(e)}},n.fn.JSONView=function(){var e,t,i,s,a,c,p;return e=arguments,null!=l[e[0]]?(a=e[0],this.each(function(){var t,r;return t=n(this),null!=e[1]?(r=e[1],t.find(".jsonview .collapsible.level"+r).siblings(".collapser").each(function(){return l[a](this)})):t.find(".jsonview > ul > li .collapsible").siblings(".collapser").each(function(){return l[a](this)})})):(s=e[0],c=e[1]||{},t={collapsed:!1,nl2br:!1,recursive_collapser:!1,escape:!0},c=n.extend(t,c),i=new o({nl2br:c.nl2br,escape:c.escape}),"[object String]"===Object.prototype.toString.call(s)&&(s=JSON.parse(s)),p=i.jsonToHTML(s),this.each(function(){var e,t,o,l,i,s;for(e=n(this),e.html(p),o=e[0].getElementsByClassName("collapsible"),s=[],l=0,i=o.length;i>l;l++)t=o[l],"LI"===t.parentNode.nodeName?s.push(r.bindEvent(t.parentNode,c)):s.push(void 0);return s}))},e(document).ready(function(){e("button.btn-raw").click(function(t){let n=e(t.target).closest(".jsonwidget"),r=n.find("textarea"),o=n.find("button.btn-parsed");r.val(JSON.stringify(JSON.parse(r.val()),null,2)),n.find("textarea").show(),n.find(".parsed").hide(),e(t.target).hide(),e(o).show()}),e("button.btn-parsed").click(function(t){let n=e(t.target).closest(".jsonwidget"),r=n.find("textarea"),o=n.find("div.parsed"),l=n.find("button.btn-raw");e(t.target).hide(),e(l).show();let i=!0;try{JSON.parse(r.val())}catch(t){i=!1}i?(r.hide(),n.find(".parsed").show(),o.JSONView(r.val(),{strict:!0}).css({overflow:"auto",resize:"both"})):console.error("Enter valid JSON.")}),e("button.btn-collapse").click(function(t){let n=e(t.target).closest(".jsonwidget"),r=n.find("div.parsed");r.JSONView("collapse")}),e("button.btn-expand").click(function(t){let n=e(t.target).closest(".jsonwidget"),r=n.find("div.parsed");r.JSONView("expand")}),e(".jsonwidget").each(function(t){"parsed"==e(this).attr("data-initial")&&e(this).find("button.btn-parsed").click()})}))})("undefined"!=typeof jQuery?jQuery:django.jQuery);